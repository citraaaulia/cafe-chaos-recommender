<!DOCTYPE html>
<html lang="en" id="backgroud">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

  <!-- Style kecil khusus dropdown header -->
  <style>
    .account { position: relative; }
    .account-btn{
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 14px; background:#C7CFB7; color:#0E140C;
      border:1px solid rgba(0,0,0,.4); border-radius:2px; cursor:pointer;
      line-height:1; font: inherit;
    }
    .account-btn img{ display:inline-block; }
    .account-btn:focus{ outline:2px solid rgba(0,0,0,.2); outline-offset:2px; }
    .account-menu{
      position:absolute; right:0; top:calc(100% + 8px);
      min-width:180px; background:#fff; color:#2b2b2b;
      border:1px solid rgba(0,0,0,.2); box-shadow:0 8px 20px rgba(0,0,0,.12);
      border-radius:2px; padding:10px 0; z-index:1000;
    }
    .account-menu a{
      display:block; padding:10px 18px; text-decoration:none; color:inherit;
      white-space:nowrap;
    }
    .account-menu a:hover{ background:rgba(0,0,0,.04); }
  </style>
</head>
<body>
  <div>
    <div class="header-admin">
      <header class="top-bar-admin">
        <!-- Left: brand / burger + nav -->
        <div class="nav-shell">
          <!-- Hamburger (mobile only) -->
          <button class="hamburger" id="hamburger-btn" aria-label="Menu" aria-expanded="false" aria-controls="nav-admin">
            <span></span><span></span><span></span>
          </button>

          <!-- Nav -->
          <nav class="nav-admin" id="nav-admin">
            <form action="{{ url_for('admin.menu_list') }}" method="get">
              <button type="submit"
                      class="nav-btn {% if request.endpoint == 'admin.menu_list' %}active{% endif %}">
                Daftar Menu
              </button>
            </form>

            <form action="{{ url_for('admin.riwayat') }}" method="get">
              <button type="submit"
                      class="nav-btn {% if request.endpoint == 'admin.riwayat' %}active{% endif %}">
                Riwayat
              </button>
            </form>

            <form action="{{ url_for('admin.manajemen_input') }}" method="get">
              <button type="submit"
                      class="nav-btn {% if request.endpoint in ['admin.manajemen_input','admin.manage_options'] %}active{% endif %}">
                Manajemen Input
              </button>
            </form>
          </nav>
        </div>

        <!-- Right: Profile dropdown -->
        <div class="account">
          <button class="account-btn" id="account-btn" aria-label="Akun" aria-expanded="false" aria-controls="account-menu">
            <img src="{{ url_for('static', filename='icons/profile.svg') }}" alt="" width="18" height="18">
            <span>{{ session.get('username', 'Admin') }}</span>
            <img id="caret-icon"
                 src="{{ url_for('static', filename='icons/dropdown-close.svg') }}"
                 alt="" width="14" height="14">
          </button>

          <div class="account-menu" id="account-menu" hidden>
            <a href="{{ url_for('admin.change_password') }}">Ganti Password</a>
            <a href="{{ url_for('admin.logout') }}">Logout</a>
          </div>
        </div>
      </header>
    </div>
  </div>

  <main style="padding: 20px;">
    {% block content %}{% endblock %}
  </main>

  <script src="{{ url_for('static', filename='js/ui.js') }}"></script>

  <!-- JS kecil untuk dropdown akun -->
  <script>
    (function(){
      const btn   = document.getElementById('account-btn');
      const menu  = document.getElementById('account-menu');
      const caret = document.getElementById('caret-icon');
      if(!btn || !menu) return;

      function openMenu(){
        menu.hidden = false;
        btn.setAttribute('aria-expanded','true');
        if(caret) caret.src = "{{ url_for('static', filename='icons/dropdown-open.svg') }}";
      }
      function closeMenu(){
        menu.hidden = true;
        btn.setAttribute('aria-expanded','false');
        if(caret) caret.src = "{{ url_for('static', filename='icons/dropdown-close.svg') }}";
      }
      function toggleMenu(e){
        e.stopPropagation();
        menu.hidden ? openMenu() : closeMenu();
      }

      btn.addEventListener('click', toggleMenu);
      document.addEventListener('click', (e)=>{
        if(!menu.hidden && !btn.contains(e.target) && !menu.contains(e.target)) closeMenu();
      });
      document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') closeMenu(); });
    })();
  </script>
</body>
</html>
